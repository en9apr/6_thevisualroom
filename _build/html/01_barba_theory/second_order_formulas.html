<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1.5.4. Second Order Formulas &#8212; The Visual Room</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="The Visual Room" href="../index.html" />
    <link rel="up" title="1. Computational Fluid Dynamics - Theory" href="barba_cfd_theory.html" />
    <link rel="next" title="1.5.5. Spectral Analysis of Errors" href="spectral_analysis.html" />
    <link rel="prev" title="1.5.3. The Diffusion of Heaviside and Sinusoidal Input" href="heavy_side_and_sinusoidal_input.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>The Visual Room</span></a></h1>
        <h2 class="heading"><span>1.5.4. Second Order Formulas</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="heavy_side_and_sinusoidal_input.html">1.5.3. The Diffusion of Heaviside and Sinusoidal Input</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="spectral_analysis.html">1.5.5. Spectral Analysis of Errors</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="second-order-formulas">
<h1>1.5.4. Second Order Formulas<a class="headerlink" href="#second-order-formulas" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#question" id="id1">Question</a></li>
<li><a class="reference internal" href="#selection-of-the-mesh-points" id="id2">Selection of the Mesh Points</a></li>
<li><a class="reference internal" href="#finite-difference-formula-with-three-coefficients" id="id3">Finite Difference Formula with Three Coefficients</a></li>
<li><a class="reference internal" href="#taylor-expansion-for-i-2-and-i-1" id="id4">Taylor Expansion for i-2 and i-1</a></li>
<li><a class="reference internal" href="#substitute-and-into" id="id5">Substitute <a href="#equation-2">(2)</a> and <a href="#equation-3">(3)</a> into <a href="#equation-1">(1)</a></a></li>
<li><a class="reference internal" href="#compare-the-coefficients" id="id6">Compare the Coefficients</a></li>
<li><a class="reference internal" href="#update-formula-for" id="id7">Update Formula for <span class="math">\(u_{x}\)</span></a></li>
</ul>
</div>
<div class="section" id="question">
<h2><a class="toc-backref" href="#id1">1.5.4.1. Question</a><a class="headerlink" href="#question" title="Permalink to this headline">¶</a></h2>
<p>How to define a <strong>second order</strong> finite difference formula for three upwind points?</p>
</div>
<div class="section" id="selection-of-the-mesh-points">
<h2><a class="toc-backref" href="#id2">1.5.4.2. Selection of the Mesh Points</a><a class="headerlink" href="#selection-of-the-mesh-points" title="Permalink to this headline">¶</a></h2>
<p>Choose: <span class="math">\((i-2)\)</span>, <span class="math">\((i-1)\)</span> and <span class="math">\(i\)</span></p>
</div>
<div class="section" id="finite-difference-formula-with-three-coefficients">
<h2><a class="toc-backref" href="#id3">1.5.4.3. Finite Difference Formula with Three Coefficients</a><a class="headerlink" href="#finite-difference-formula-with-three-coefficients" title="Permalink to this headline">¶</a></h2>
<div class="math" id="equation-1">
<span class="eqno">(1)</span>\[(u_x)_i = {{a u_i + b u_{i-1} + c u_{i-2}} \over {\Delta x}} + O(\Delta x^2)\]</div>
</div>
<div class="section" id="taylor-expansion-for-i-2-and-i-1">
<h2><a class="toc-backref" href="#id4">1.5.4.4. Taylor Expansion for i-2 and i-1</a><a class="headerlink" href="#taylor-expansion-for-i-2-and-i-1" title="Permalink to this headline">¶</a></h2>
<div class="math" id="equation-2">
<span class="eqno">(2)</span>\[u_{i-1} = u_i - \Delta x(u_x)_i +
                 {{(\Delta x)^2} \over 2}(u_{xx})_i -
                 {{(\Delta x)^3} \over 6}(u_{xxx})_i +
                 O(\Delta x^4)\]</div>
<div class="math" id="equation-3">
<span class="eqno">(3)</span>\[u_{i-2} = u_i - 2 \Delta x(u_x)_i +
                 {{(2 \Delta x)^2} \over 2}(u_{xx})_i -
                 {{(2 \Delta x)^3} \over 6}(u_{xxx})_i +
                 O(\Delta x^4)\]</div>
</div>
<div class="section" id="substitute-and-into">
<h2><a class="toc-backref" href="#id5">1.5.4.5. Substitute <a href="#equation-2">(2)</a> and <a href="#equation-3">(3)</a> into <a href="#equation-1">(1)</a></a><a class="headerlink" href="#substitute-and-into" title="Permalink to this headline">¶</a></h2>
<div class="math" id="equation-4">
<span class="eqno">(4)</span>\[(u_x)_i = {{a u_i + b u_{i-1} + c u_{i-2}} \over {\Delta x}} =
                 {{(a+b+c) u_i - \Delta x(b+2c)(u_x)_i +
                 {{\Delta x^2} \over 2} (b+4c)(u_{xx})_i} \over {\Delta x}}\]</div>
</div>
<div class="section" id="compare-the-coefficients">
<h2><a class="toc-backref" href="#id6">1.5.4.6. Compare the Coefficients</a><a class="headerlink" href="#compare-the-coefficients" title="Permalink to this headline">¶</a></h2>
<div class="math">
\[a + b + c = 0 \quad \Rightarrow \quad a = 1.5\]</div>
<div class="math">
\[b + 2c = -1 \quad \Rightarrow \quad -4c + 2c = -1 \quad \Rightarrow \quad c=0.5\]</div>
<div class="math">
\[b + 4c = 0 \quad \Rightarrow \quad b = -4c \quad \Rightarrow \quad b = -2\]</div>
</div>
<div class="section" id="update-formula-for">
<h2><a class="toc-backref" href="#id7">1.5.4.7. Update Formula for <span class="math">\(u_{x}\)</span></a><a class="headerlink" href="#update-formula-for" title="Permalink to this headline">¶</a></h2>
<div class="math">
\[(u_{x})_i =  {{3 u_i -4 u_{i-1} + u_{i-2}} \over {2 \Delta x}}\]</div>
<p><strong>Notice that the Formula</strong> <span class="math">\(a+b+c=0\)</span> <strong>applies for all finite difference formulas</strong></p>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="heavy_side_and_sinusoidal_input.html">1.5.3. The Diffusion of Heaviside and Sinusoidal Input</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="spectral_analysis.html">1.5.5. Spectral Analysis of Errors</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6.
    </div>
  </body>
</html>